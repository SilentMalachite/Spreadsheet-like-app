# チュートリアル

プロ表計算ソフトの基本的な使い方から高度な機能まで、段階的に学習できるガイドです。

## 目次

1. [はじめに](#はじめに)
2. [基本操作](#基本操作)
3. [数式の使用](#数式の使用)
4. [ファイル操作](#ファイル操作)
5. [キーボードショートカット](#キーボードショートカット)
6. [高度な機能](#高度な機能)
7. [よくある質問](#よくある質問)

## はじめに

### アプリケーションの起動

1. プロジェクトフォルダを開く
2. ターミナルで `npm run dev` を実行
3. Electronアプリを起動する場合は `npm run electron`

### 画面構成

アプリケーションは以下の要素で構成されています：

- **ツールバー**: ファイル操作、編集機能、書式設定
- **数式バー**: 選択セルの数式や値を表示・編集
- **スプレッドシートグリッド**: セルの表示・編集エリア
- **ステータスバー**: 現在の状態や選択セル情報

## 基本操作

### セルの選択と移動

#### マウス操作
- セルをクリックして選択
- ドラッグして範囲選択（将来実装予定）

#### キーボード操作
- `↑↓←→` 矢印キーでセル移動
- `Home` で行の先頭に移動
- `End` で行の末尾に移動

### セルの編集

#### 編集開始の方法
1. **ダブルクリック**: セルをダブルクリック
2. **F2キー**: セル選択後にF2を押す
3. **Enterキー**: セル選択後にEnterを押す
4. **直接入力**: セル選択後に文字・数字を入力

#### 編集の確定・キャンセル
- `Enter`: 編集内容を確定して下のセルに移動
- `Tab`: 編集内容を確定して右のセルに移動
- `Escape`: 編集をキャンセル

### 実践例: 基本的なデータ入力

1. A1セルをクリックして選択
2. 「商品名」と入力してEnter
3. B1セルに「価格」と入力してEnter
4. A2セルに「りんご」と入力
5. B2セルに「100」と入力

```
    A      B
1  商品名  価格
2  りんご  100
3
```

## 数式の使用

### 基本的な演算

#### 四則演算
- 加算: `=A1+B1`
- 減算: `=A1-B1`
- 乗算: `=A1*B1`
- 除算: `=A1/B1`

#### 実践例: 消費税計算
1. A1に「価格」、B1に「税率」、C1に「税込価格」
2. A2に「1000」、B2に「0.1」
3. C2に `=A2*(1+B2)` と入力

```
    A      B      C
1  価格   税率   税込価格
2  1000   0.1    1100
```

### 関数の使用

#### SUM関数（合計）
```
=SUM(A1:A5)    # A1からA5までの合計
=SUM(A1:B5)    # A1からB5までの範囲の合計
```

#### AVERAGE関数（平均）
```
=AVERAGE(A1:A10)  # A1からA10までの平均
```

#### MAX/MIN関数（最大値・最小値）
```
=MAX(A1:A10)   # 最大値
=MIN(A1:A10)   # 最小値
```

#### COUNT関数（個数）
```
=COUNT(A1:A10)  # 数値セルの個数
```

#### IF関数（条件分岐）
```
=IF(A1>100, "高い", "安い")
=IF(B1="", "未入力", B1)
```

### 実践例: 売上集計表

以下のような売上データを作成してみましょう：

```
     A        B      C       D
1   商品     単価   数量    金額
2   りんご   100     5    =B2*C2
3   みかん   80      3    =B3*C3
4   ばなな   120     2    =B4*C4
5   合計            10   =SUM(D2:D4)
6   平均           =AVERAGE(C2:C4)  =AVERAGE(D2:D4)
```

手順：
1. ヘッダー行（1行目）を入力
2. データ行（2-4行目）を入力
3. D2セルに `=B2*C2` と入力
4. D3、D4セルにも同様の数式を入力
5. D5セルに `=SUM(D2:D4)` と入力
6. C6セルに `=AVERAGE(C2:C4)` と入力

## ファイル操作

### 新規作成
- ツールバーの「新規」ボタンをクリック
- 空のスプレッドシートが作成されます

### 保存
1. ツールバーの「保存」ボタンをクリック
2. ファイル名を入力
3. 保存場所を選択
4. 「保存」をクリック

### 読み込み
1. ツールバーの「開く」ボタンをクリック
2. ファイルを選択
3. 「開く」をクリック

### CSVエクスポート
1. 「ファイル」メニューから「CSVエクスポート」を選択
2. 保存場所とファイル名を指定
3. Excelなどで開くことができます

## キーボードショートカット

### 移動・選択
| キー | 動作 |
|------|------|
| `↑↓←→` | セル移動 |
| `Home` | 行の先頭 |
| `End` | 行の末尾 |
| `Ctrl+Home` | A1セル |

### 編集
| キー | 動作 |
|------|------|
| `F2` | 編集開始 |
| `Enter` | 編集確定・下移動 |
| `Tab` | 編集確定・右移動 |
| `Escape` | 編集キャンセル |
| `Delete` | セル内容削除 |

### ファイル操作
| キー | 動作 |
|------|------|
| `Ctrl+N` | 新規作成 |
| `Ctrl+O` | ファイルを開く |
| `Ctrl+S` | 保存 |

### 編集操作
| キー | 動作 |
|------|------|
| `Ctrl+C` | コピー |
| `Ctrl+V` | ペースト |
| `Ctrl+Z` | 元に戻す |
| `Ctrl+Y` | やり直し |

## 高度な機能

### セルの書式設定

#### フォント書式
- **太字**: ツールバーの「B」ボタンまたは `Ctrl+B`
- **斜体**: ツールバーの「I」ボタンまたは `Ctrl+I`
- **下線**: ツールバーの「U」ボタンまたは `Ctrl+U`

#### 書式設定の手順
1. 書式を変更したいセルを選択
2. ツールバーの書式ボタンをクリック
3. 右クリックメニューから「セルの書式設定」を選択

### 行・列の操作

#### 行の挿入・削除
1. 行番号を右クリック
2. 「行を挿入」または「行を削除」を選択

#### 列の挿入・削除
1. 列のヘッダー（A、B、C...）を右クリック
2. 「列を挿入」または「列を削除」を選択

### コピー・ペースト

#### 基本的なコピー・ペースト
1. コピーしたいセルを選択
2. `Ctrl+C` でコピー
3. 貼り付け先を選択
4. `Ctrl+V` でペースト

#### 数式のコピー
数式をコピーする際、セル参照は自動的に調整されます：
- A1の `=B1+C1` をA2にコピーすると `=B2+C2` になります

## よくある質問

### Q: 数式が計算されません
**A:** 以下を確認してください：
- 数式が `=` で始まっているか
- セル参照が正しいか（A1、B2など）
- 参照先のセルに数値が入っているか

### Q: ファイルが保存できません
**A:** 以下を確認してください：
- 保存先フォルダの書き込み権限があるか
- ファイル名に使用できない文字が含まれていないか
- ディスクの容量は十分か

### Q: キーボードショートカットが効きません
**A:** 以下を確認してください：
- アプリケーションがアクティブになっているか
- 他のアプリケーションがキーを占有していないか
- 日本語入力がオフになっているか

### Q: セルに長い文字が入りません
**A:** セルの幅は自動調整されません。以下の方法で対応：
- 列境界をドラッグして幅を調整
- 文字列を改行して入力
- セルの書式設定で文字の配置を調整

### Q: 数式の結果が #ERROR! になります
**A:** エラーの原因：
- 参照先のセルが存在しない
- 数式の構文が間違っている
- ゼロ除算が発生している
- 数値以外の値で計算しようとしている

### Q: コピーした数式の参照がずれます
**A:** これは正常な動作です：
- 相対参照：コピー先に応じて自動調整
- 絶対参照：`$A$1` のように記述（将来実装予定）

## トラブルシューティング

### パフォーマンスが悪い場合
- 大量のセルに数式がある場合は計算を見直す
- 不要なセルの内容を削除する
- アプリケーションを再起動する

### データが消えた場合
- `Ctrl+Z` で元に戻す機能を使用
- 最近保存したファイルから復元
- ブラウザのlocalStorageを確認（開発者向け）

## 次のステップ

このチュートリアルを完了したら：
1. [API リファレンス](API.md)で詳細な技術情報を確認
2. [コントリビューションガイド](../CONTRIBUTING.md)で開発への参加方法を学習
3. 実際のプロジェクトでスプレッドシート機能を活用

## フィードバック

チュートリアルの改善点や質問があれば、GitHubのIssuesでお知らせください。皆様のフィードバックが製品向上に役立ちます。